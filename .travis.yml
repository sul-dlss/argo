sudo: required
services:
  - docker

language: ruby
addons:
  chrome: stable
rvm:
  - 2.3.4 # deployed

jdk:
  - oraclejdk8

email: false

before_install:
  - docker-compose --version
  - docker-compose pull
  - docker-compose build
  - docker-compose start
  - google-chrome-stable --headless --disable-gpu --no-sandbox --remote-debugging-port=9222 http://localhost &

before_script:
  - bin/rails db:test:prepare

script: bundle exec rake ci
after_script:
- bundle exec codeclimate-test-reporter

env:
  global:
  - NOKOGIRI_USE_SYSTEM_LIBRARIES=true # speeds up bundle install

cache: bundler
