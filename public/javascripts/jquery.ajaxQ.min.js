(function(f){function g(c){var b=e[c],d=b.requests.shift();d&&(b.pending++,d.ajaxOptions.dequeued&&d.ajaxOptions.dequeued(d.xhr),b=f.ajax(d.ajaxOptions),b.success(function(a,b,c){d.deferred.resolve(a,b,c)}),b.error(function(a,b,c){d.deferred.reject(a,b,c)}),b.complete(function(){e[c].pending--;g(c)}))}function i(c,b,d){var a=e[c];a.requests.push({ajaxOptions:b,deferred:d});a.pending<=a.opts.maxRequests&&g(c)}function h(c,b){var d=e[c];if(d)for(var a=0;a<d.requests.length;a++)d.requests[a].deferred==
b&&(d.requests.splice(a,1),b.reject(b,"aborted"));else throw"QueueError: queue '"+options.queue+"' is not defined.";}var e={};f.extend({ajaxQ:function(c,b){if(e.hasOwnProperty(c))throw"QueueError: queue '"+options.queue+"' is already defined.";else{var d=e,a;a=b||{};a.maxRequests=a.maxRequests||5;d[c]={pending:0,requests:[],opts:a}}},clearQ:function(c){var b=e[c];if(b)for(;b.requests.length>0;)h(c,b.requests[0].deferred);else throw"QueueError: queue '"+options.queue+"' is not defined.";}});var j=
f.ajax;f.ajax=function(c){if(c.ajaxQ){var b=c.ajaxQ;if(e.hasOwnProperty(b)){var d=f.Deferred(),a=d.promise();a.success=a.done;a.error=a.fail;a.complete=a.then;a.abort=function(){h(queueName,d)};delete c.ajaxQ;i(b,c,d);return a}else throw"QueueError: queue '"+options.queue+"' is not defined.";}else return j(c)}})(jQuery);
